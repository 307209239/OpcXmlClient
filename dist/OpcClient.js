(()=>{"use strict";var e={484:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ListActions=void 0,(n=t.ListActions||(t.ListActions={})).Change="change",n.Replace="replace"},741:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OpcContainer=void 0;const s=n(576);class i extends s.OpcObject{}t.OpcContainer=i},809:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OpcContainerList=void 0;const s=n(242);class i extends s.OpcObjectList{}t.OpcContainerList=i},225:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OpcDataField=void 0;const s=n(576);class i extends s.OpcObject{IsDataField(){return!0}SetValue(e){let t=this.DomElement.ownerDocument.createCDATASection(e);this.DomElement.appendChild(t)}}t.OpcDataField=i},134:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OpcDataList=void 0;const s=n(395);class i extends s.OpcList{}t.OpcDataList=i},308:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OpcDocument=void 0;const s=n(661),i=n(183);t.OpcDocument=class{constructor(e){this.Session=e,this.RequestDocument=document.implementation.createDocument("","",null);var t=this.RequestDocument.createElement("__InSite");t.setAttribute("__version","1.1"),t.setAttribute("__encryption","2"),this.RequestDocument.appendChild(t),this.RootElement=new s.OpcXmlElement(this,t),this.ResponseDocument=null}CreateDomElement(e){return this.RequestDocument.createElement(e)}Submit(){return this.Session.Submit(this.RequestDocument)}CheckError(){return!0}GetRootElement(){return this.RootElement}CheckErrors(){let e=[!1,""];if(null!=this.ResponseDocument){let t=this.ResponseDocument.getElementsByTagName("__exceptionData");for(let n in t){e[1]=i.XmlHelper.GetValue(t[0].getElementsByTagName("__errorDescription")[0]),e[0]=!0;break}return e}return[!1,"没有返回值"]}}},173:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OpcField=void 0;const s=n(661);class i extends s.OpcXmlElement{IsField(){return!0}}t.OpcField=i},367:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OpcHelper=void 0;const s=n(369),i=n(720),r=n(663);t.OpcHelper=class{constructor(e,t,n,r,o,c=!0){this.Session=new i.OpcSession(e,t,n,r),this.Service=c?new s.OpcService(this.Session.Document,null,"__service",this.Session.Document.GetRootElement()):null;let l=o+"_doc";this.Session.RemoveDocument(l)}ChangesNDO(e){return this.InputData().NamedObjectField("ObjectToChange").SetRef(e),this.Perform(r.PerformType.Load),this.InputData().NamedObjectField("ObjectChanges")}NewNDO(e){var t;return this.Perform(r.PerformType.New),null===(t=this.InputData())||void 0===t?void 0:t.NamedObjectField("ObjectChanges")}Perform(e){if(null==this.Service)return null;let t;switch(e){case r.PerformType.Load:t="Load";break;case r.PerformType.New:t="New";break;case r.PerformType.Change:t="Load";break;case r.PerformType.Delete:t="delete";break;case r.PerformType.NewRev:t="NewRev"}return this.Service.Perform(t)}InputData(){if(null!=this.Service)return this.Service.InputData();throw new Error("Service 没有实例化")}RequestData(){var e;return null===(e=this.Service)||void 0===e?void 0:e.RequestData()}Submit(){return Promise.race([this.Session.Document.Submit()])}ExecuteResult(){var e=this;return Promise.race([new Promise((function(t){var n,s;let i=[!1,""];null===(n=e.Service)||void 0===n||n.SetExecute(),null===(s=e.RequestData())||void 0===s||s.RequestField("CompletionMsg"),e.Submit().then((function(e){i=null==e?void 0:e.CheckErrors(),i[0]=!i[0],t(i)}))}))])}}},395:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OpcList=void 0;const s=n(484),i=n(173),r=n(661),o=n(183);class c extends i.OpcField{IsList(){return!0}SetListAction(e){switch(e){case s.ListActions.Change:this.DomElement.setAttribute("__listAction","change");break;case s.ListActions.Replace:this.DomElement.setAttribute("__listAction","replace");break;default:throw new Error("ListActions 错误")}}GetListItems(){let e=this.DomElement.getElementsByTagName("__listItem"),t=new Array;for(let n in e)t.push(new r.OpcXmlElement(this.Docment,e[n]));return t}DeleteItemByIndex(e){var t=new r.OpcXmlElement(this.Docment,null,"__listItemAction",this);t.DomElement.setAttribute("__listItemAction","delete"),o.XmlHelper.SetValue(t,"__index",e.toString())}GetItem(e){let t=this.DomElement.getElementsByTagName("__listItem");for(let n in t)if(parseInt(n)===e)return new r.OpcXmlElement(this.Docment,t[n]);throw new Error("index 索引超出范围")}}t.OpcList=c},728:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OpcNameObject=void 0;const s=n(576),i=n(183);class r extends s.OpcObject{IsNamedObject(){return!0}SetRef(e){i.XmlHelper.SetValue(this,"__name",e,!0)}GetRef(){return this.DomElement.nodeValue}}t.OpcNameObject=r},107:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OpcNamedObjectList=void 0;const s=n(242);class i extends s.OpcObjectList{}t.OpcNamedObjectList=i},675:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OpcNamedSubentity=void 0;const s=n(576);class i extends s.OpcObject{}t.OpcNamedSubentity=i},175:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OpcNamedSubentityList=void 0;const s=n(242);class i extends s.OpcObjectList{}t.OpcNamedSubentityList=i},576:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OpcObject=void 0;const s=n(173);class i extends s.OpcField{NamedObjectField(e){return new r.OpcNameObject(this.Docment,null,e,this)}DataField(e){return new c.OpcDataField(this.Docment,null,e,this)}Perform(e){let t=new o.OpcPerform(this.Docment,null,"__perform",this);return new c.OpcDataField(this.Docment,null,"__eventName",t).SetValue(e),t}SetObjectId(e){let t=this.FindChildByName("__Id");null==t&&(t=new c.OpcDataField(this.Docment,null,"__Id",this)),t.SetValue(e)}ObjectField(e){return new i(this.Docment,null,e,this)}ObjectList(e){return new l.OpcObjectList(this.Docment,null,e,this)}DataList(e){return new a.OpcDataList(this.Docment,null,e,this)}ContainerList(e){return new u.OpcContainerList(this.Docment,null,e,this)}SubentityList(e){return new m.OpcSubentityList(this.Docment,null,e,this)}NamedObjectList(e){return new d.OpcNamedObjectList(this.Docment,null,e,this)}RevisionedObjectList(e){return new p.OpcRevisionedObjectList(this.Docment,null,e,this)}NamedSubentityList(e){return new O.OpcNamedSubentityList(this.Docment,null,e,this)}SubentityField(e){return new h.OpcSubentity(this.Docment,null,e,this)}ContainerField(e){return new D.OpcContainer(this.Docment,null,e,this)}NamedSubentityField(e){return new v.OpcNamedSubentity(this.Docment,null,e,this)}RevisionedObjectField(e){return new b.OpcRevisionedObject(this.Docment,null,e,this)}}t.OpcObject=i;const r=n(728),o=n(227),c=n(225),l=n(242),a=n(134),u=n(809),m=n(41),d=n(107),p=n(490),O=n(175),h=n(911),D=n(741),v=n(675),b=n(957)},242:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OpcObjectList=void 0;const s=n(395),i=n(576);class r extends s.OpcList{IsObjectList(){return!0}AppendItemById(e){new i.OpcObject(this.Docment,null,"__listItem",this).SetObjectId(e)}GetItemByName(e){return this.GetListItems().forEach((t=>{var n;if((null===(n=t.FindChildByName("__name"))||void 0===n?void 0:n.GetValue())==e)return t})),null}}t.OpcObjectList=r},227:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OpcPerform=void 0;const s=n(661);class i extends s.OpcXmlElement{}t.OpcPerform=i},796:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OpcRequestData=void 0;const s=n(173),i=n(108);class r extends s.OpcField{RequestField(e){return new i.OpcRequestField(this.Docment,null,e,this)}}t.OpcRequestData=r},108:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OpcRequestField=void 0;const s=n(173);class i extends s.OpcField{}t.OpcRequestField=i},957:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OpcRevisionedObject=void 0;const s=n(576);class i extends s.OpcObject{}t.OpcRevisionedObject=i},490:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OpcRevisionedObjectList=void 0;const s=n(242);class i extends s.OpcObjectList{}t.OpcRevisionedObjectList=i},369:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OpcService=void 0;const s=n(576),i=n(796),r=n(661);class o extends s.OpcObject{InputData(){return new s.OpcObject(this.Docment,null,"__inputData",this)}SetExecute(){null==this.FindChildByName("__execute")&&new r.OpcXmlElement(this.Docment,null,"__execute",this)}RequestData(){let e=this.FindChildByName("__requestData");return null!=e?new i.OpcRequestData(this.Docment,e.DomElement):new i.OpcRequestData(this.Docment,null,"__requestData",this)}}t.OpcService=o},720:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OpcSession=void 0;const s=n(308),i=n(728),r=n(661);t.OpcSession=class{constructor(e,t,n,o){this.SessionId="",this.Document=new s.OpcDocument(this);let c=new r.OpcXmlElement(this.Document,null,"__session",this.Document.GetRootElement());if(this.APIUrl="https://"+e+":"+t+"/CamstarAppServer/api",this.SessionId.length>0){let e=c.Docment.CreateDomElement("__useSession"),t=(new i.OpcNameObject(this.Document,null,"user",new r.OpcXmlElement(this.Document,e)).SetRef(n),c.Docment.CreateDomElement("sessionId"));t.setAttribute("__encrypted","no"),t.appendChild(c.DomElement.ownerDocument.createCDATASection("aaaaaaaaaaaaaaaaaaaaaaa")),e.appendChild(t),c.DomElement.appendChild(e)}}CreateDocument(e){if(e.length<=0)throw new Error("CreateDocument 错误 name 不能为空")}RemoveDocument(e){}Submit(e){let t=this.Document,n=this.APIUrl;return new Promise((function(s){let i=new XMLHttpRequest;i.open("POST",n),i.setRequestHeader("Access-Control-Allow-Origin","*"),i.send(e),i.onreadystatechange=function(){4==i.readyState&&200==i.status&&(t.ResponseDocument=this.responseXML,s(t))}}))}static GetSessionId(e,t,n,s){let i='<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:tem="http://tempuri.org/"><soapenv:Header/><soapenv:Body><tem:LoginFromXMLClient><tem:userName>'+n+"</tem:userName><tem:password>"+s+"</tem:password><tem:sessionGuid></tem:sessionGuid></tem:LoginFromXMLClient></soapenv:Body></soapenv:Envelope>",r=new XMLHttpRequest;return r.open("POST","https://"+e+":"+t+"/camstarsecurityservices/authenticationservice.svc?wsdl"),r.setRequestHeader("Content-Type","text/xml;charset=utf-8"),r.setRequestHeader("SOAPAction","http://tempuri.org/IAuthenticationService/LoginFromXMLClient"),r.withCredentials=!0,r.send(i),r.onreadystatechange=function(){4==r.readyState&&r.status},""}}},911:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OpcSubentity=void 0;const s=n(576);class i extends s.OpcObject{}t.OpcSubentity=i},41:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OpcSubentityList=void 0;const s=n(242);class i extends s.OpcObjectList{}t.OpcSubentityList=i},661:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OpcXmlElement=void 0;const s=n(183);class i{constructor(e,t,n="",s=null){if(this.Docment=e,null!=t)this.DomElement=t;else{if(n.length<=0)throw new Error("CreateTag 错误：name不能为空");this.DomElement=this.Docment.CreateDomElement(n);let e=new i(this.Docment,this.DomElement);null==s||s.AppendChild(e)}}FindChildByName(e){let t=this.DomElement.getElementsByTagName(e);return t.length>0?new i(this.Docment,t.item(0)):null}AppendChild(e){this.DomElement.appendChild(e.DomElement)}IsField(){return!1}IsObject(){return!1}IsContainer(){return!1}IsList(){return!1}IsNamedObject(){return!1}IsService(){return!1}IsRevisionedObject(){return!1}IsRequestData(){return!1}IsDataField(){return!1}IsSubentity(){return!1}IsDataList(){return!1}IsContainerList(){return!1}IsNamedObjectList(){return!1}IsRevisionedObjectList(){return!1}IsSubentityList(){return!1}IsNamedSubentityList(){return!1}IsNamedSubentity(){return!1}IsObjectList(){return!1}GetValue(){return s.XmlHelper.GetValue(this.DomElement)}}t.OpcXmlElement=i},663:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.PerformType=void 0,(n=t.PerformType||(t.PerformType={}))[n.Load=0]="Load",n[n.New=1]="New",n[n.Change=2]="Change",n[n.Delete=3]="Delete",n[n.NewRev=4]="NewRev"},183:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.XmlHelper=void 0;const s=n(661);t.XmlHelper=class{static SetValue(e,t,n,i=!0){var r;let o=null===(r=e.FindChildByName(t))||void 0===r?void 0:r.DomElement;null!=o&&e.DomElement.removeChild(o);let c=new s.OpcXmlElement(e.Docment,null,t,e);i&&c.DomElement.appendChild(e.DomElement.ownerDocument.createCDATASection(n))}static GetValue(e){if(null==e)return"";let t=e.innerHTML;return t.indexOf("<![CDATA[")>=0?t.substring(9,t.length-3):e.innerHTML}}}},t={};function n(s){var i=t[s];if(void 0!==i)return i.exports;var r=t[s]={exports:{}};return e[s](r,r.exports,n),r.exports}var s={};(()=>{var e=s;Object.defineProperty(e,"__esModule",{value:!0});const t=n(367);console.info("start");var i=new t.OpcHelper("192.168.18.129",443,"camstaradmin","abc123..","FactoryMaint"),r=i.ChangesNDO("F1");r.DataField("Description").SetValue("123"),r.NamedObjectField("AAA").SetRef("CC"),r.ObjectList("BB"),i.ExecuteResult().then((function(e){e[0]?console.info(e[1]):console.error(e[1])})),console.info("end")})(),exports.OpcClient=s})();